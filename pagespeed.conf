pagespeed on;

# Needs to exist and be writable by nginx.  Use tmpfs for best performance.
pagespeed FileCachePath /var/ngx_pagespeed_cache;

# Ensure requests for pagespeed optimized resources go to the pagespeed handler
# and no extraneous headers get set.
location ~ "\.pagespeed\.([a-z]\.)?[a-z]{2}\.[^.]{10}\.[^.]+" {
  add_header "" "";
}
location ~ "^/pagespeed_static/" { }
location ~ "^/ngx_pagespeed_beacon$" { }

pagespeed LowercaseHtmlNames on;
pagespeed RewriteLevel OptimizeForBandwidth;
pagespeed InPlaceResourceOptimization on;
pagespeed EnableFilters add_head,combine_heads,inline_import_to_link,rewrite_css,flatten_css_imports,inline_google_font_css;
pagespeed EnableFilters insert_image_dimensions,recompress_images,resize_mobile_images,remove_comments,collapse_whitespace;
pagespeed EnableFilters extend_cache_images,extend_cache_pdfs,convert_meta_tags,insert_dns_prefetch,combine_css,combine_javascript;
pagespeed EnableFilters dedup_inlined_images,inline_css;
pagespeed DisableFilters rewrite_images,convert_png_to_jpeg,convert_jpeg_to_webp,convert_gif_to_png,recompress_jpeg;
pagespeed DisableFilters recompress_png,recompress_webp,extend_cache_css;
